(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const l of i)if(l.type==="childList")for(const o of l.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const l={};return i.integrity&&(l.integrity=i.integrity),i.referrerPolicy&&(l.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?l.credentials="include":i.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(i){if(i.ep)return;i.ep=!0;const l=n(i);fetch(i.href,l)}})();const ae=!1,de=(e,t)=>e===t,B={equals:de};let ee=ie;const b=1,I=2,te={owned:null,cleanups:null,context:null,owner:null},q={};var p=null;let V=null,pe=null,c=null,g=null,m=null,_=0;function he(e,t){const n=c,s=p,i=e.length===0,l=t===void 0?s:t,o=i?te:{owned:null,cleanups:null,context:l?l.context:null,owner:l},r=i?e:()=>e(()=>x(()=>R(o)));p=o,c=null;try{return A(r,!0)}finally{c=n,p=s}}function P(e,t){t=t?Object.assign({},B,t):B;const n={value:e,observers:null,observerSlots:null,comparator:t.equals||void 0},s=i=>(typeof i=="function"&&(i=i(n.value)),re(n,i));return[se.bind(n),s]}function ge(e,t,n){const s=W(e,t,!0,b);L(s)}function D(e,t,n){const s=W(e,t,!1,b);L(s)}function ne(e,t,n){ee=xe;const s=W(e,t,!1,b);s.user=!0,m?m.push(s):L(s)}function we(e,t,n){n=n?Object.assign({},B,n):B;const s=W(e,t,!0,0);return s.observers=null,s.observerSlots=null,s.comparator=n.equals||void 0,L(s),se.bind(s)}function ye(e){return e&&typeof e=="object"&&"then"in e}function ve(e,t,n){let s,i,l;s=!0,i=e,l={};let o=null,r=q,f=!1,u="initialValue"in l,a=typeof s=="function"&&we(s);const y=new Set,[S,U]=(l.storage||P)(l.initialValue),[N,fe]=P(void 0),[$e,ue]=P(void 0,{equals:!1}),[K,Q]=P(u?"ready":"unresolved");function E(h,d,v,w){return o===h&&(o=null,w!==void 0&&(u=!0),(h===r||d===r)&&l.onHydrated&&queueMicrotask(()=>l.onHydrated(w,{value:d})),r=q,ce(d,v)),d}function ce(h,d){A(()=>{d===void 0&&U(()=>h),Q(d!==void 0?"errored":u?"ready":"unresolved"),fe(d);for(const v of y.keys())v.decrement();y.clear()},!1)}function F(){const h=Se,d=S(),v=N();if(v!==void 0&&!o)throw v;return c&&c.user,d}function j(h=!0){if(h!==!1&&f)return;f=!1;const d=a?a():s;if(d==null||d===!1){E(o,x(S));return}let v;const w=r!==q?r:x(()=>{try{return i(d,{value:S(),refetching:h})}catch(O){v=O}});if(v!==void 0){E(o,void 0,T(v),d);return}else if(!ye(w))return E(o,w,void 0,d),w;return o=w,"v"in w?(w.s===1?E(o,w.v,void 0,d):E(o,void 0,T(w.v),d),w):(f=!0,queueMicrotask(()=>f=!1),A(()=>{Q(u?"refreshing":"pending"),ue()},!1),w.then(O=>E(w,O,void 0,d),O=>E(w,void 0,T(O),d)))}Object.defineProperties(F,{state:{get:()=>K()},error:{get:()=>N()},loading:{get(){const h=K();return h==="pending"||h==="refreshing"}},latest:{get(){if(!u)return F();const h=N();if(h&&!o)throw h;return S()}}});let J=p;return a?ge(()=>(J=p,j(!1))):j(!1),[F,{refetch:h=>be(J,()=>j(h)),mutate:U}]}function x(e){if(c===null)return e();const t=c;c=null;try{return e()}finally{c=t}}function me(e){ne(()=>x(e))}function be(e,t){const n=p,s=c;p=e,c=null;try{return A(t,!0)}catch(i){G(i)}finally{p=n,c=s}}const[ke,Me]=P(!1);let Se;function se(){if(this.sources&&this.state)if(this.state===b)L(this);else{const e=g;g=null,A(()=>k(this),!1),g=e}if(c){const e=this.observers?this.observers.length:0;c.sources?(c.sources.push(this),c.sourceSlots.push(e)):(c.sources=[this],c.sourceSlots=[e]),this.observers?(this.observers.push(c),this.observerSlots.push(c.sources.length-1)):(this.observers=[c],this.observerSlots=[c.sources.length-1])}return this.value}function re(e,t,n){let s=e.value;return(!e.comparator||!e.comparator(s,t))&&(e.value=t,e.observers&&e.observers.length&&A(()=>{for(let i=0;i<e.observers.length;i+=1){const l=e.observers[i],o=V&&V.running;o&&V.disposed.has(l),(o?!l.tState:!l.state)&&(l.pure?g.push(l):m.push(l),l.observers&&oe(l)),o||(l.state=b)}if(g.length>1e6)throw g=[],new Error},!1)),t}function L(e){if(!e.fn)return;R(e);const t=_;Ae(e,e.value,t)}function Ae(e,t,n){let s;const i=p,l=c;c=p=e;try{s=e.fn(t)}catch(o){return e.pure&&(e.state=b,e.owned&&e.owned.forEach(R),e.owned=null),e.updatedAt=n+1,G(o)}finally{c=l,p=i}(!e.updatedAt||e.updatedAt<=n)&&(e.updatedAt!=null&&"observers"in e?re(e,s):e.value=s,e.updatedAt=n)}function W(e,t,n,s=b,i){const l={fn:e,state:s,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:p,context:p?p.context:null,pure:n};return p===null||p!==te&&(p.owned?p.owned.push(l):p.owned=[l]),l}function $(e){if(e.state===0)return;if(e.state===I)return k(e);if(e.suspense&&x(e.suspense.inFallback))return e.suspense.effects.push(e);const t=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<_);)e.state&&t.push(e);for(let n=t.length-1;n>=0;n--)if(e=t[n],e.state===b)L(e);else if(e.state===I){const s=g;g=null,A(()=>k(e,t[0]),!1),g=s}}function A(e,t){if(g)return e();let n=!1;t||(g=[]),m?n=!0:m=[],_++;try{const s=e();return Ee(n),s}catch(s){n||(m=null),g=null,G(s)}}function Ee(e){if(g&&(ie(g),g=null),e)return;const t=m;m=null,t.length&&A(()=>ee(t),!1)}function ie(e){for(let t=0;t<e.length;t++)$(e[t])}function xe(e){let t,n=0;for(t=0;t<e.length;t++){const s=e[t];s.user?e[n++]=s:$(s)}for(t=0;t<n;t++)$(e[t])}function k(e,t){e.state=0;for(let n=0;n<e.sources.length;n+=1){const s=e.sources[n];if(s.sources){const i=s.state;i===b?s!==t&&(!s.updatedAt||s.updatedAt<_)&&$(s):i===I&&k(s,t)}}}function oe(e){for(let t=0;t<e.observers.length;t+=1){const n=e.observers[t];n.state||(n.state=I,n.pure?g.push(n):m.push(n),n.observers&&oe(n))}}function R(e){let t;if(e.sources)for(;e.sources.length;){const n=e.sources.pop(),s=e.sourceSlots.pop(),i=n.observers;if(i&&i.length){const l=i.pop(),o=n.observerSlots.pop();s<i.length&&(l.sourceSlots[o]=s,i[s]=l,n.observerSlots[s]=o)}}if(e.tOwned){for(t=e.tOwned.length-1;t>=0;t--)R(e.tOwned[t]);delete e.tOwned}if(e.owned){for(t=e.owned.length-1;t>=0;t--)R(e.owned[t]);e.owned=null}if(e.cleanups){for(t=e.cleanups.length-1;t>=0;t--)e.cleanups[t]();e.cleanups=null}e.state=0}function T(e){return e instanceof Error?e:new Error(typeof e=="string"?e:"Unknown error",{cause:e})}function G(e,t=p){throw T(e)}function Ce(e,t){return x(()=>e(t||{}))}function Le(e,t,n){let s=n.length,i=t.length,l=s,o=0,r=0,f=t[i-1].nextSibling,u=null;for(;o<i||r<l;){if(t[o]===n[r]){o++,r++;continue}for(;t[i-1]===n[l-1];)i--,l--;if(i===o){const a=l<s?r?n[r-1].nextSibling:n[l-r]:f;for(;r<l;)e.insertBefore(n[r++],a)}else if(l===r)for(;o<i;)(!u||!u.has(t[o]))&&t[o].remove(),o++;else if(t[o]===n[l-1]&&n[r]===t[i-1]){const a=t[--i].nextSibling;e.insertBefore(n[r++],t[o++].nextSibling),e.insertBefore(n[--l],a),t[i]=n[l]}else{if(!u){u=new Map;let y=r;for(;y<l;)u.set(n[y],y++)}const a=u.get(t[o]);if(a!=null)if(r<a&&a<l){let y=o,S=1,U;for(;++y<i&&y<l&&!((U=u.get(t[y]))==null||U!==a+S);)S++;if(S>a-r){const N=t[o];for(;r<a;)e.insertBefore(n[r++],N)}else e.replaceChild(n[r++],t[o++])}else o++;else t[o++].remove()}}}function Ue(e,t,n,s={}){let i;return he(l=>{i=l,t===document?e():Ne(t,e(),t.firstChild?null:void 0,n)},s.owner),()=>{i(),t.textContent=""}}function le(e,t,n,s){let i;const l=()=>{const r=document.createElement("template");return r.innerHTML=e,r.content.firstChild},o=()=>(i||(i=l())).cloneNode(!0);return o.cloneNode=o,o}function X(e,t,n){return x(()=>e(t,n))}function Ne(e,t,n,s){if(n!==void 0&&!s&&(s=[]),typeof t!="function")return M(e,t,s,n);D(i=>M(e,t(),i,n),s)}function M(e,t,n,s,i){for(;typeof n=="function";)n=n();if(t===n)return n;const l=typeof t,o=s!==void 0;if(e=o&&n[0]&&n[0].parentNode||e,l==="string"||l==="number"){if(l==="number"&&(t=t.toString(),t===n))return n;if(o){let r=n[0];r&&r.nodeType===3?r.data!==t&&(r.data=t):r=document.createTextNode(t),n=C(e,n,s,r)}else n!==""&&typeof n=="string"?n=e.firstChild.data=t:n=e.textContent=t}else if(t==null||l==="boolean")n=C(e,n,s);else{if(l==="function")return D(()=>{let r=t();for(;typeof r=="function";)r=r();n=M(e,r,n,s)}),()=>n;if(Array.isArray(t)){const r=[],f=n&&Array.isArray(n);if(H(r,t,n,i))return D(()=>n=M(e,r,n,s,!0)),()=>n;if(r.length===0){if(n=C(e,n,s),o)return n}else f?n.length===0?Y(e,r,s):Le(e,n,r):(n&&C(e),Y(e,r));n=r}else if(t.nodeType){if(Array.isArray(n)){if(o)return n=C(e,n,s,t);C(e,n,null,t)}else n==null||n===""||!e.firstChild?e.appendChild(t):e.replaceChild(t,e.firstChild);n=t}}return n}function H(e,t,n,s){let i=!1;for(let l=0,o=t.length;l<o;l++){let r=t[l],f=n&&n[e.length],u;if(!(r==null||r===!0||r===!1))if((u=typeof r)=="object"&&r.nodeType)e.push(r);else if(Array.isArray(r))i=H(e,r,f)||i;else if(u==="function")if(s){for(;typeof r=="function";)r=r();i=H(e,Array.isArray(r)?r:[r],Array.isArray(f)?f:[f])||i}else e.push(r),i=!0;else{const a=String(r);f&&f.nodeType===3&&f.data===a?e.push(f):e.push(document.createTextNode(a))}}return i}function Y(e,t,n=null){for(let s=0,i=t.length;s<i;s++)e.insertBefore(t[s],n)}function C(e,t,n,s){if(n===void 0)return e.textContent="";const i=s||document.createTextNode("");if(t.length){let l=!1;for(let o=t.length-1;o>=0;o--){const r=t[o];if(i!==r){const f=r.parentNode===e;!l&&!o?f?e.replaceChild(i,r):e.insertBefore(i,n):f&&r.remove()}else l=!0}}else e.insertBefore(i,n);return[i]}const Z=""+new URL("../worker.js",import.meta.url).href;var Oe=le('<iframe title="Bene Reader"src=bene-reader/index.html referrerpolicy=no-referrer>'),Pe=le("<input type=file style=display:none>");const z=new URL(window.location.href).searchParams.get("preload");async function Re(){new BroadcastChannel("log-channel").addEventListener("message",s=>console.debug("Service worker:",s.data));const n=(await navigator.serviceWorker.getRegistrations()).find(s=>s.active&&s.active.scriptURL===Z);if(n)return console.debug("Found existing worker registration",n),n.active&&navigator.serviceWorker.controller===null&&window.location.reload(),n;{console.debug("No existing worker registration, creating new one");const s=new Promise(l=>navigator.serviceWorker.addEventListener("controllerchange",o=>{l(void 0)})),i=await navigator.serviceWorker.register(Z);return console.debug(`Registered worker at scope ${i.scope}, waiting for it to activate.`,i),await s,console.assert(i.active!==null,"Service worker is not active?"),console.debug("Successfully activated service worker."),i}}function Te(e){const t=e.pathname.split("/bene-reader/")[1];return`${encodeURIComponent(t)}$${e.hash.slice(1)}`}function Be(e){if(e.hash==="")return;const n=e.hash.slice(1).split("$"),s=decodeURIComponent(n[0]),i=n.slice(1).join("-");return`${s}#${i}`}function Ie(){let e,t;const[n]=ve(async()=>{let o=await Re();return navigator.serviceWorker.addEventListener("message",r=>{const f=r.data;f.type==="loaded-epub"&&e.contentWindow.postMessage({type:"loaded-epub",data:{status:"ok",data:f.data}})}),o}),s=(o,r)=>{const f=n(),u=Be(window.location),a={type:"new-epub",data:{data:o,scope:f.scope,url:r?.href,path:u}};f.active.postMessage(a)};async function i(o){const r=new URL(o,window.location.href),u=await(await fetch(r)).arrayBuffer();s(new Uint8Array(u),r)}ne(()=>{n()&&z&&i(z)});function l(o){const r=new FileReader;r.onload=async f=>{if(!f.target)return;const u=f.target.result,a=new Uint8Array(u);s(a)},r.readAsArrayBuffer(o)}return me(()=>{window.addEventListener("message",o=>{if(o.source!==e.contentWindow)return;const r=o.data;if(console.info("Parent window received message",r),r.type==="request-upload")t.click();else if(r.type==="finished-upload"){const f=r.data;l(f)}else if(r.type==="navigate"){const f=new URL(r.data),u=Te(f);window.history.replaceState(void 0,"",`#${u}`)}else if(r.type==="open-url"){const f=r.data;window.open(f,"_blank")}else r.type==="ready"||console.warn("Unhandled message",r)})}),[(()=>{var o=Oe(),r=e;return typeof r=="function"?X(r,o):e=o,o})(),(()=>{var o=Pe();o.addEventListener("change",f=>{let u=f.target.files;if(u?.length&&u.length>0){const a=u[0];l(a)}});var r=t;return typeof r=="function"?X(r,o):t=o,o})()]}Ue(()=>Ce(Ie,{}),document.getElementById("root"));
